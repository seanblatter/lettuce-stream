<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plans Comparison - Lettuce Stream</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="plans-body">
    <nav class="plans-nav">
        <a href="dashboard.html" class="logo">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="32" height="32" rx="8" fill="#F5D547"/>
                <path d="M12 9L22 16L12 23V9Z" fill="#2D3748"/>
            </svg>
            <span class="logo-text">Lettuce Stream</span>
        </a>
        <div class="nav-actions">
            <a href="dashboard.html" class="btn-secondary">Back to Dashboard</a>
            <button type="button" class="btn-primary" data-plan-tier="pro">Upgrade Now</button>
        </div>
    </nav>

    <main class="plans-main">
        <section class="plans-hero">
            <p class="eyebrow">Plans</p>
            <h1>Compare plans and unlock streaming</h1>
            <p>Stay on your trial while you evaluate, then pick the billing cadence that matches your production calendar.</p>
        </section>

        <section class="plans-grid" id="billing">
            <div class="plans-toggle-row">
                <p class="plans-toggle-copy">Choose your billing cadence</p>
                <div class="billing-toggle" role="group" aria-label="Select billing cadence">
                    <button type="button" class="toggle-option active" data-plans-billing="monthly">Monthly</button>
                    <button type="button" class="toggle-option" data-plans-billing="yearly">Yearly</button>
                </div>
            </div>
            <article class="plan-card" data-plan-card="starter">
                <h3>Starter</h3>
                <p class="plan-description">For emerging creators learning multi-streaming fundamentals.</p>
                <p class="plan-price"><span data-plan-amount>$9</span> <span data-plan-period>/month</span></p>
                <p class="plan-note" data-plan-note>Billed monthly, cancel anytime.</p>
                <ul class="plan-feature-list">
                    <li>Stream to 2 destinations</li>
                    <li>1080p HD output</li>
                    <li>Basic analytics</li>
                    <li>Email support</li>
                    <li>50 hours per month</li>
                </ul>
                <button type="button" class="btn-outline plan-cta" data-plan-tier="starter">Choose Starter</button>
            </article>

            <article class="plan-card featured" data-plan-card="pro">
                <h3>Pro</h3>
                <p class="plan-description">Best for growing channels that need automation and full-fidelity delivery.</p>
                <p class="plan-price"><span data-plan-amount>$25</span> <span data-plan-period>/month</span></p>
                <p class="plan-note" data-plan-note>Billed monthly, cancel anytime.</p>
                <ul class="plan-feature-list">
                    <li>Stream to 4 destinations</li>
                    <li>4K streaming + recording</li>
                    <li>Advanced analytics & alerts</li>
                    <li>Custom branding & overlays</li>
                    <li>Unlimited streaming hours</li>
                </ul>
                <button type="button" class="btn-primary plan-cta" data-plan-tier="pro">Go Pro</button>
            </article>

            <article class="plan-card" data-plan-card="enterprise">
                <h3>Enterprise</h3>
                <p class="plan-description">For studios and teams that need collaboration, compliance, and white-glove care.</p>
                <p class="plan-price"><span data-plan-amount>$85</span> <span data-plan-period>/month</span></p>
                <p class="plan-note" data-plan-note>Billed monthly, cancel anytime.</p>
                <ul class="plan-feature-list">
                    <li>Stream to 5 destinations</li>
                    <li>Everything in Pro</li>
                    <li>5 team seats included</li>
                    <li>White-label player and API</li>
                    <li>24/7 phone & chat support</li>
                </ul>
                <button type="button" class="btn-secondary plan-cta" data-plan-tier="enterprise">Choose Enterprise</button>
            </article>
        </section>

        <section class="plans-table">
            <h3>Feature breakdown</h3>
            <div class="table-scroll">
                <table>
                    <thead>
                        <tr>
                            <th>Capability</th>
                            <th>Starter</th>
                            <th>Pro</th>
                            <th>Enterprise</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Platforms</td>
                            <td>Up to 2</td>
                            <td>All 8</td>
                            <td>All 8 + custom RTMP</td>
                        </tr>
                        <tr>
                            <td>Streaming quality</td>
                            <td>1080p</td>
                            <td>4K + adaptive bitrate</td>
                            <td>4K + dedicated CDN</td>
                        </tr>
                        <tr>
                            <td>Scheduling</td>
                            <td>Single events</td>
                            <td>Playlists & recurring</td>
                            <td>Team-wide calendar</td>
                        </tr>
                        <tr>
                            <td>Support</td>
                            <td>Email</td>
                            <td>Priority chat</td>
                            <td>24/7 phone + TAM</td>
                        </tr>
                        <tr>
                            <td>Automation</td>
                            <td>Basic triggers</td>
                            <td>Full workflow builder</td>
                            <td>Advanced API automations</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="plans-footer-cta">
            <h3>Need a custom package?</h3>
            <p>Bundle multi-channel licenses, bespoke integrations, or managed production services and we'll tailor pricing to your studio.</p>
            <a href="mailto:hello@lettucestream.com" class="btn-secondary">Contact Sales</a>
        </section>
    </main>

    <!-- Firebase + Stripe for upgrade routing -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://js.stripe.com/v3/"></script>

    <script src="firebase-config.js"></script>
    <script src="auth-helpers.js"></script>
    <script src="auth.js"></script>
    <script>
        let activeUser = null;
        const planButtons = document.querySelectorAll('[data-plan-tier]');
        const billingToggleButtons = document.querySelectorAll('[data-plans-billing]');
        const planCards = document.querySelectorAll('[data-plan-card]');
        const PLAN_PRICING = {
            starter: {
                monthly: { amount: 9, period: '/month', note: 'Billed monthly, cancel anytime.', slug: 'starter-monthly' },
                yearly: { amount: 108, period: '/year', note: 'Billed annually ($9/mo equivalent).', slug: 'starter-yearly' }
            },
            pro: {
                monthly: { amount: 25, period: '/month', note: 'Billed monthly, cancel anytime.', slug: 'pro-monthly' },
                yearly: { amount: 300, period: '/year', note: 'Billed annually ($25/mo equivalent).', slug: 'pro-yearly' }
            },
            enterprise: {
                monthly: { amount: 85, period: '/month', note: 'Billed monthly, cancel anytime.', slug: 'enterprise-monthly' },
                yearly: { amount: 1020, period: '/year', note: 'Billed annually ($85/mo equivalent).', slug: 'enterprise-yearly' }
            }
        };
        let activeBillingMode = 'monthly';

        if (typeof auth !== 'undefined') {
            auth.onAuthStateChanged((user) => {
                activeUser = user || null;
            });
        }

        billingToggleButtons.forEach((button) => {
            button.addEventListener('click', () => {
                const mode = button.dataset.plansBilling;
                if (mode && mode !== activeBillingMode) {
                    setBillingMode(mode);
                }
            });
        });

        setBillingMode('monthly');

        planButtons.forEach((button) => {
            button.addEventListener('click', () => {
                const tier = button.dataset.planTier;
                const planSlug = resolvePlanSlug(tier);
                handlePlanSelection(planSlug);
            });
        });

        function setBillingMode(mode) {
            if (!['monthly', 'yearly'].includes(mode)) {
                return;
            }
            activeBillingMode = mode;
            billingToggleButtons.forEach((button) => {
                button.classList.toggle('active', button.dataset.plansBilling === mode);
            });
            planCards.forEach((card) => {
                const tier = card.dataset.planCard;
                const config = PLAN_PRICING[tier]?.[mode];
                if (!config) {
                    return;
                }
                const amountEl = card.querySelector('[data-plan-amount]');
                const periodEl = card.querySelector('[data-plan-period]');
                const noteEl = card.querySelector('[data-plan-note]');
                if (amountEl) {
                    amountEl.textContent = formatCurrency(config.amount);
                }
                if (periodEl) {
                    periodEl.textContent = config.period;
                }
                if (noteEl) {
                    noteEl.textContent = config.note;
                }
            });
        }

        function formatCurrency(value) {
            const amount = Number(value || 0);
            return `$${amount.toLocaleString('en-US')}`;
        }

        function resolvePlanSlug(tier) {
            const config = PLAN_PRICING[tier]?.[activeBillingMode];
            if (config?.slug) {
                return config.slug;
            }
            return `${tier || 'pro'}-monthly`;
        }

        function handlePlanSelection(plan) {
            if (activeUser) {
                startPlanCheckout(plan);
                return;
            }
            window.location.href = `signup.html?plan=${plan}`;
        }

        function startPlanCheckout(plan) {
            if (typeof redirectToStripeCheckout === 'function') {
                const userId = activeUser && activeUser.uid ? activeUser.uid : '';
                redirectToStripeCheckout(userId, plan);
                return;
            }
            window.location.href = `checkout.html?plan=${plan}`;
        }
    </script>
</body>
</html>
